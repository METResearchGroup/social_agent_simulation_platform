# API contract (backend â†” frontend)

The FastAPI backend is the source of truth for request/response shapes via Pydantic
schemas in `simulation/api/schemas/`.

To prevent frontend drift, the UI consumes OpenAPI-generated TypeScript types:

- OpenAPI spec snapshot: `ui/openapi.json` (generated from `simulation.api.main:app`)
- Generated TS types: `ui/types/api.generated.ts` (generated by `openapi-typescript`)

## Regenerating

From the repository root:

```bash
cd ui
npm run generate:api
```

This regenerates both `ui/openapi.json` and `ui/types/api.generated.ts`.

## CI check

CI runs:

```bash
cd ui
npm run check:api
```

and fails if the generated files are out of date.

## Consuming types in the UI

Prefer referencing schemas from the generated file instead of re-declaring API
interfaces, e.g.:

- `components['schemas']['RunResponse']`
- `components['schemas']['TurnSchema']`
- `components['schemas']['PostSchema']`

